"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../external/@babel/runtime/helpers/esm/classCallCheck.js"),t=require("../../external/@babel/runtime/helpers/esm/createClass.js"),r=require("../../external/@babel/runtime/helpers/esm/inherits.js"),l=require("../../external/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),n=require("../../external/@babel/runtime/helpers/esm/getPrototypeOf.js"),o=require("react"),a=require("classnames"),s=require("../../utility/react/react.js"),c=require("../../utility/object/object.js"),i=require("./Scrollable.utils.js"),u=require("../../tools/ResizeObserver/ResizeObserver.js"),p=require("./components/VerticalScrollbar/VerticalScrollbar.js"),d=require("./components/VerticalScrollbar/VerticalScrollbar.placeholder.js"),f=require("./components/HorizontalScrollbar/HorizontalScrollbar.js"),h=require("./components/HorizontalScrollbar/HorizontalScrollbar.placeholder.js");require("./components/Shadow/Shadow.js");var m=require("./Scrollable.context.js"),v=require("./Scrollable.props.js"),b=require("./Scrollable.constants.js");function y(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./Scrollable2.js");var S=y(o),j=y(a);function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=n.default(e);if(t){var a=n.default(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return l.default(this,r)}}var E=function(l){r.default(o,l);var n=q(o);function o(t){var r;return e.default(this,o),(r=n.call(this,t)).handleOnScroll=function(e){var t=r.container.current;r.updateScrollbars(),r.props.onScroll(r.event.next),e.target===t&&(t.parentElement.classList.add("scrolling"),clearTimeout(r.timeout),r.timeout=setTimeout((function(){t.parentElement.classList.remove("scrolling")}),b.SCROLLING_CLASS_REMOVAL_DELAY))},r.getEvent=function(){if(!r.container.current)return{};var e=r.container.current,t=e.clientHeight,l=e.clientWidth,n=e.scrollTop,o=e.scrollLeft,a=e.scrollHeight,s=e.scrollWidth,c=Math.ceil(n),u=Math.ceil(o);return{top:i.normalizeScrollPosition(a,t,c),left:i.normalizeScrollPosition(s,l,u),scrollTop:c,scrollLeft:u,scrollHeight:a,scrollWidth:s,clientHeight:t,clientWidth:l}},r.updateScrollbars=function(){if(r.event.next=r.getEvent(),!c.isEqual(r.event.prev,r.event.next)){var e=r.container.current.parentElement;r.props.onUpdate(r.event.next);var t=r.event.next.clientHeight/r.event.next.scrollHeight,l=r.event.next.clientWidth/r.event.next.scrollWidth;t<1?e.classList.add("vertically-scrollable"):e.classList.remove("vertically-scrollable"),l<1?e.classList.add("horizontally-scrollable"):e.classList.remove("horizontally-scrollable"),e.style.setProperty("--scrollable-vertical-ratio",t),e.style.setProperty("--scrollable-horizontal-ratio",l),e.style.setProperty("--scrollable-scroll-top",r.event.next.top),e.style.setProperty("--scrollable-scroll-left",r.event.next.left)}r.event.prev=r.event.next},r.getElementProps=function(){var e=r.props.element;return{className:j.default("scrollbar-inner",e.props.className),ref:s.copyComponentRef(e.ref,r.container),onScroll:r.handleOnScroll}},r.handleOnTransitionEnd=function(e){"height"!==e.propertyName&&"width"!==e.propertyName||r.updateScrollbars()},r.container=S.default.createRef(),r.ctx={container:r.container},r.event={prev:{},next:{}},r}return t.default(o,[{key:"getSnapshotBeforeUpdate",value:function(){var e=this.container.current;return{scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}}},{key:"componentDidMount",value:function(){this.updateScrollbars()}},{key:"componentDidUpdate",value:function(e,t,r){var l=r.scrollTop,n=r.scrollLeft;this.props.scrollOnDOMChange||(this.container.current.scrollTop=l,this.container.current.scrollLeft=n),this.updateScrollbars()}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.style,l=e.element,n=s.findChildByType(t,d.default),o=s.findChildByType(t,h.default),a=S.default.Children.toArray(t).filter((function(e){return![d.default,h.default].includes(e.type)}));return S.default.createElement(u.default,{onResize:this.updateScrollbars},S.default.createElement("div",{className:"scrollbar",style:r,onTransitionEnd:this.handleOnTransitionEnd},S.default.cloneElement(l,this.getElementProps(),a),S.default.createElement(m.default.Provider,{value:this.ctx},n?n.props.children:S.default.createElement(p.default,null),o?o.props.children:S.default.createElement(f.default,null))))}}]),o}(S.default.PureComponent);E.propTypes=v.propTypes,E.defaultProps=v.defaultProps,exports.default=E;
